(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23321192"],{"927d":function(e,t,a){},abae:function(e,t,a){"use strict";a("927d")},e805:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"container"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-search"}),e._v(" 查询条件：")])],1)],1),a("el-row",{attrs:{gutter:20}},["1"!==e.limitShow&&"2"!==e.limitShow?a("el-col",{attrs:{sm:5}},[a("el-select",{attrs:{placeholder:"告警类型"},model:{value:e.searchCondition.conditionArray,callback:function(t){e.$set(e.searchCondition,"conditionArray",t)},expression:"searchCondition.conditionArray"}},e._l(e.selectAlarmType,(function(e){return a("el-option",{key:e.id,attrs:{label:e.propListName,value:e.propListCode}})})),1)],1):e._e(),a("el-col",{attrs:{sm:5}},[a("el-select",{attrs:{placeholder:"请选择学校"},on:{change:e.changeSchoolCopy},model:{value:e.searchCondition.schoolId,callback:function(t){e.$set(e.searchCondition,"schoolId",t)},expression:"searchCondition.schoolId"}},e._l(e.selectSchoolCopy,(function(e){return a("el-option",{key:e.id,attrs:{label:e.schoolName,value:e.id}})})),1)],1),a("el-col",{attrs:{sm:5}},[a("el-select",{attrs:{placeholder:"请选择年级"},on:{change:e.changeGradeCopy},model:{value:e.searchCondition.gradeId,callback:function(t){e.$set(e.searchCondition,"gradeId",t)},expression:"searchCondition.gradeId"}},e._l(e.selectGradeCopy,(function(e){return a("el-option",{key:e.id,attrs:{label:e.gradeName,value:e.id}})})),1)],1),a("el-col",{attrs:{sm:5}},[a("el-select",{attrs:{placeholder:"请选择班级"},model:{value:e.searchCondition.classId,callback:function(t){e.$set(e.searchCondition,"classId",t)},expression:"searchCondition.classId"}},e._l(e.selectClassCopy,(function(e){return a("el-option",{key:e.id,attrs:{label:e.className,value:e.id}})})),1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{sm:5}},[a("el-input",{attrs:{placeholder:"学生姓名"},model:{value:e.searchCondition.name,callback:function(t){e.$set(e.searchCondition,"name",t)},expression:"searchCondition.name"}})],1),a("el-col",{attrs:{sm:5}},[a("el-input",{attrs:{placeholder:"学生手机号"},model:{value:e.searchCondition.phone,callback:function(t){e.$set(e.searchCondition,"phone",t)},expression:"searchCondition.phone"}})],1),a("el-col",{attrs:{sm:10}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeQueryDate},model:{value:e.queryDate,callback:function(t){e.queryDate=t},expression:"queryDate"}})],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{md:7}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchInfo}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.resetSearch}},[e._v("重置")])],1)],1),a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 查询结果：")])],1)],1),a("div",{staticClass:"handle-box"},[a("div",{staticStyle:{height:"24px"}},[a("el-popover",{attrs:{placement:"bottom-end",trigger:"click"}},[e._l(e.headerFilter,(function(t,o){return a("div",{key:o},[a("el-checkbox",{model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"item.selected"}},[e._v(e._s(t.label))])],1)})),a("el-button",{staticClass:"mr10 wzg-float-right",attrs:{slot:"reference",circle:""},slot:"reference"},[a("i",{staticClass:"iconfont iconguolv"})])],2)],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:"","reserve-selection":!0},on:{"row-dblclick":e.rowDblclick}},[a("el-table-column",{attrs:{type:"index",align:"center"}}),a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._l(e.headerFilter,(function(t,o){return[t.selected?a("el-table-column",{key:o,attrs:{prop:t.prop,align:"center",label:t.label,formatter:t.formatter}}):e._e()]})),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-view"},on:{click:function(a){return e.handleViewEdit(t.$index,t.row,"view","查看")}}},[e._v("查看")])]}}])})],2),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.searchCondition.pageSize,"current-page":e.searchCondition.pageNumber,"page-sizes":e.pageSizes,total:e.total,"hide-on-single-page":!0},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.editVisible,width:"60%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editVisible=t},closed:e.closedFormDialog}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingDialog,expression:"loadingDialog"}],ref:"alarmForm",attrs:{model:e.alarmInfoForm,"label-width":"100px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"学校：",prop:"schoolName"}},[a("el-input",{model:{value:e.alarmInfoForm.schoolName,callback:function(t){e.$set(e.alarmInfoForm,"schoolName",t)},expression:"alarmInfoForm.schoolName"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"班级：",prop:"className"}},[a("el-input",{model:{value:e.alarmInfoForm.className,callback:function(t){e.$set(e.alarmInfoForm,"className",t)},expression:"alarmInfoForm.className"}})],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"学生：",prop:"name"}},[a("el-input",{model:{value:e.alarmInfoForm.name,callback:function(t){e.$set(e.alarmInfoForm,"name",t)},expression:"alarmInfoForm.name"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"学生手机号：",prop:"phone"}},[a("el-input",{model:{value:e.alarmInfoForm.phone,callback:function(t){e.$set(e.alarmInfoForm,"phone",t)},expression:"alarmInfoForm.phone"}})],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"家长：",prop:"parentName"}},[a("el-input",{model:{value:e.alarmInfoForm.parentName,callback:function(t){e.$set(e.alarmInfoForm,"parentName",t)},expression:"alarmInfoForm.parentName"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"家长手机号：",prop:"parentPhone"}},[a("el-input",{model:{value:e.alarmInfoForm.parentPhone,callback:function(t){e.$set(e.alarmInfoForm,"parentPhone",t)},expression:"alarmInfoForm.parentPhone"}})],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"告警类型：",prop:"alarmName"}},[a("el-input",{model:{value:e.alarmInfoForm.alarmName,callback:function(t){e.$set(e.alarmInfoForm,"alarmName",t)},expression:"alarmInfoForm.alarmName"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"告警时间：",prop:"alarmTime"}},[a("el-input",{model:{value:e.alarmInfoForm.alarmTime,callback:function(t){e.$set(e.alarmInfoForm,"alarmTime",t)},expression:"alarmInfoForm.alarmTime"}})],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"经度：",prop:"lng"}},[a("el-input",{model:{value:e.alarmInfoForm.lng,callback:function(t){e.$set(e.alarmInfoForm,"lng",t)},expression:"alarmInfoForm.lng"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"纬度：",prop:"lat"}},[a("el-input",{model:{value:e.alarmInfoForm.lat,callback:function(t){e.$set(e.alarmInfoForm,"lat",t)},expression:"alarmInfoForm.lat"}})],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:15}},[a("el-form-item",{attrs:{label:"地址：",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:8,placeholder:"地址"},model:{value:e.alarmInfoForm.address,callback:function(t){e.$set(e.alarmInfoForm,"address",t)},expression:"alarmInfoForm.address"}})],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancelSubmit("alarmForm")}}},[e._v("取 消")]),e.isDisabledbtn?e._e():a("el-button",{attrs:{type:"primary",disabled:e.disabledbtn},on:{click:function(t){return e.submitForm("alarmForm",e.methodType,e.parentUrl,e.alarmInfoForm)}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.delVisible,width:"300px","close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.delVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),a("el-button",{class:{disabledbtn:e.isDisabledbtn},attrs:{type:"primary",disabled:e.disabledbtn},on:{click:function(t){return e.deleteRow(e.parentUrl)}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"提示",visible:e.loginVisible,width:"300px","close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.loginVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("登录时间过长，请重新登录")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.loginVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.Common.signOut("/login")}}},[e._v("确 定")])],1)])],1)},l=[],s=(a("159b"),a("b0c0"),a("a434"),{name:"alarmInfo",data:function(){return{Request:this.$api.api.prototype,Common:this.$common.common.prototype,USERTYPE:2,propListUrl:"",parentUrl:"",resetpwdInfoUrl:"",schoolInfoUrl:"",alarmInfoUrl:"",selectAlarmType:[],selectClassCopy:[],selectGradeCopy:[],selectClass:[],selectSchoolCopy:[],selectParentAccountCopy:[],selectSchool:[],selectSchoolTemplate:[],limitShow:localStorage.getItem("userType"),tableData:[],selectTableData:[],dialogTitle:"",editVisible:!1,delVisible:!1,loginVisible:!1,resetVisible:!1,delVisibleType:"delete",disabledbtn:!1,disabledbtnExport:!1,isDisabledbtn:!1,importVisible:!1,fileList:[],warningInfo:"",headers:{Authorization:localStorage.getItem("token")},loading:!0,loadingDialog:!1,propTypeCodeDisabled:!1,classCodeDisabled:!0,showType:"add",methodType:"post",total:8,pageSizes:[8,20,30,40,50,100],templateForm:{schoolId:""},queryDate:[],searchCondition:{conditionArray:"",schoolId:"",gradeId:"",classId:"",name:"",phone:"",parentName:"",parentPhone:"",startTime:"",endTime:"",pagination:1,pageNumber:1,pageSize:8},alarmInfoForm:{imei:"",lat:"",lng:"",schoolName:"",className:"",alarmName:"",alarmTime:"",name:"",phone:"",parentName:"",parentPhone:"",address:""},headerFilter:[{prop:"alarmTime",label:"告警时间",selected:!0},{prop:"alarmType",label:"告警类型",selected:!0},{prop:"name",label:"学生",selected:!0},{prop:"schoolName",label:"学校",selected:!0},{prop:"class",label:"班级",formatter:this.formatterClassName,selected:!0},{prop:"phone",label:"学生手机号",selected:!0}],idx:-1,id:-1}},created:function(){this.alarmInfoUrl=this.Request.getAlarmInfoUrl(),this.getListDataRequest()},computed:{},methods:{changeQueryDate:function(e){null!==e?(this.searchCondition.startTime=this.Common.renderTime(e[0]),this.searchCondition.endTime=this.Common.renderTime(e[1])):(this.searchCondition.startTime="",this.searchCondition.endTime="")},handleCurrentChange:function(e){this.searchCondition.pageNumber=e,this.getListDataRequest()},handleSizeChange:function(e){this.searchCondition.pageSize=e,this.getListDataRequest()},formatterClassName:function(e){return e.grade+"年级"+e.class+"班级"},formatterAlarmTime:function(e){if(null!==e.alarmTime||""!==e.alarmTime){var t=e.alarmTime.indexOf("-");return e.alarmTime.substring(t+1)}return e.alarmTime},getAlarmTypeRequest:function(){this.Common.getAxios(this.propListUrl,{propTypeCode:"ALARM_TYPE"},this.getPropList,["selectAlarmType"])},getListDataRequest:function(){this.Common.getAxios(this.alarmInfoUrl,"",this.getListData)},getSchoolInfoDataRequest:function(){this.Common.getAxios(this.schoolInfoUrl,{pagination:"0"},this.getSchoolData)},getListData:function(e){if(200===e.status){var t=e.data;this.loading=!1,this.tableData=t.data,this.total=t.data.length}else 401===e.status?this.loginVisible=!0:(this.$message.error("服务器繁忙，请稍后再试"),this.loading=!1)},getPropList:function(e,t){var a=this;if(200===e.status){var o=e.data;if(!this.validToken(o))return;0===o.code&&""!==o.result&&t.forEach((function(e){a[e]=o.result}))}else this.$message.error("服务器繁忙，请稍后再试")},getSchoolData:function(e){if(200===e.status){var t=e.data;if(this.loading=!1,!this.validToken(t))return;0===t.code&&""!==t.result&&(this.selectSchoolCopy=t.result.rows,this.selectSchool=t.result.rows,this.selectSchoolTemplate=t.result.rows)}else this.$message.error("服务器繁忙，请稍后再试"),this.loading=!1},getGradeCopyInfoData:function(e){if(200===e.status){var t=e.data;if(!this.validToken(t))return;0===t.code&&""!==t.result&&(this.searchCondition.gradeId="",this.searchCondition.classId="",this.selectClassCopy=[],this.selectGradeCopy=t.result)}else this.$message.error("服务器繁忙，请稍后再试")},getClassInfoCopyData:function(e){if(200===e.status){var t=e.data;if(!this.validToken(t))return;0===t.code&&""!==t.result&&(this.searchCondition.classId="",this.selectClassCopy=t.result)}else this.$message.error("服务器繁忙，请稍后再试")},changeSchoolCopy:function(e){this.Common.getAxios(this.gradeInfoUrl,{schoolId:e},this.getGradeCopyInfoData)},changeGradeCopy:function(e){this.Common.getAxios(this.classInfoUrl,{gradeId:e},this.getClassInfoCopyData)},rowDblclick:function(e){this.$refs.multipleTable.toggleRowSelection(e)},handleViewEdit:function(e,t,a,o){"view"===a?(this.dialogTitle=o,this.isDisabledbtn=!0):"edit"===a&&(this.dialogTitle=o,this.methodType="put"),this.alarmInfoForm.id=t.id,this.alarmInfoForm.imei=t.imei,this.alarmInfoForm.lat=t.lat,this.alarmInfoForm.lng=t.lng,this.alarmInfoForm.schoolName=t.school.schoolName,this.alarmInfoForm.className=t.grade.gradeName+t.class.className,this.alarmInfoForm.alarmName=t.alarmName,this.alarmInfoForm.alarmTime=t.alarmTime,this.alarmInfoForm.name=t.name,this.alarmInfoForm.phone=t.phone,this.alarmInfoForm.parentName=t.parent.realName,this.alarmInfoForm.parentPhone=t.parent.phone,this.alarmInfoForm.address=t.address,this.showType=a,this.propTypeCodeDisabled=!0,this.classCodeDisabled=!0,this.editVisible=!0},handleDelete:function(e,t){this.idx=e,this.id=t.id,this.delVisible=!0,this.delVisibleType="delete"},searchInfo:function(){this.loading=!0,this.searchCondition.pageNumber=1,this.getListDataRequest()},resetSearch:function(){this.searchCondition.conditionArray="",this.searchCondition.schoolId="",this.searchCondition.gradeId="",this.searchCondition.classId="",this.searchCondition.name="",this.searchCondition.phone="",this.searchCondition.parentName="",this.searchCondition.parentPhone="",this.searchCondition.startTime="",this.searchCondition.endTime="",this.queryDate=[],this.searchInfo()},addData:function(){this.dialogTitle="新增",this.editVisible=!0},batchDelete:function(){var e=this.$refs.multipleTable.store.states.selection;this.selectTableData=e,e.length>0?(this.delVisible=!0,this.delVisibleType="batchDelete"):this.$message.warning("请至少选择一条数据")},closedFormDialog:function(){this.isDisabledbtn=!1,this.propTypeCodeDisabled=!1,this.classCodeDisabled=!0,this.alarmInfoForm.id="",this.alarmInfoForm.schoolId="",this.alarmInfoForm.parentName="",this.alarmInfoForm.phone="",this.alarmInfoForm.intelligent="",this.showType="add",this.methodType="post",this.$refs["alarmForm"].clearValidate()},submitForm:function(e,t,a,o){var l=this;this.disabledbtn=!0,this.loadingDialog=!0,this.$refs[e].validate((function(e){if(!e)return l.disabledbtn=!1,l.loadingDialog=!1,!1;l.Common.commonAxios(a,t,o,l.submitFormInfo)}))},submitFormInfo:function(e){if(200===e.status){var t=e.data;if(this.disabledbtn=!1,this.loadingDialog=!1,!this.validToken(t))return;0===t.code?(this.editVisible=!1,this.$message.success(t.message),this.getListDataRequest()):this.$message.error(t.message)}else this.disabledbtn=!1,this.loadingDialog=!1,this.$message.error("服务器繁忙，请稍后再试")},cancelSubmit:function(){this.editVisible=!1},deleteRow:function(e){if("delete"!==this.delVisibleType&&"batchDelete"!==this.delVisibleType)return this.delVisible=!1,void this.$message.error("别偷偷的修改特定的参数哦");var t=[],a=0,o=[];if("delete"===this.delVisibleType)o.push(this.id);else if("batchDelete"===this.delVisibleType){t=this.$refs.multipleTable.store.states.selection,a=t.length;for(var l=0;l<a;l++)o.push(t[l].id)}this.loading=!0,this.disabledbtn=!0,this.Common.deleteAxios(e,{idArray:o},this.deleteInfo,o),this.delVisible=!1},deleteInfo:function(e,t){if(this.disabledbtn=!1,this.loading=!1,200===e.status){var a=e.data;if(!this.validToken(a))return;if(0!==a.code)return void this.$message.error(a.message);for(var o=this.tableData.length-1;o>=0;o--)for(var l=0;l<t.length;l++)if(t[l]===this.tableData[o].id){this.tableData.splice(o,1);break}this.$message.success("成功删除了".concat(t.length,"条数据")),this.selectTableData=[]}else this.$message.error("服务器繁忙，请稍后再试")},validToken:function(e){return 2001!==e.code&&2101!==e.code&&2102!==e.code||(this.loginVisible=!0,!1)}}}),i=s,r=(a("abae"),a("2877")),n=Object(r["a"])(i,o,l,!1,null,"134c0f96",null);t["default"]=n.exports}}]);
//# sourceMappingURL=chunk-23321192.61fd6916.js.map