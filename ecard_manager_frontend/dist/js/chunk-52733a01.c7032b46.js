(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52733a01"],{"76d1":function(e,t,s){},d9e2:function(e,t,s){"use strict";s("76d1")},e7bb:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"table"},[s("div",{staticClass:"container"},[s("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"",name:"1"}},[s("template",{slot:"title"},[s("i",{staticClass:"header-icon el-icon-setting"}),e._v("设置学校范围及迟到时间： ")]),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-col",{attrs:{span:18}},[s("el-input",{attrs:{placeholder:"请输入学校范围"},model:{value:e.fence,callback:function(t){e.fence=t},expression:"fence"}},[s("template",{slot:"prepend"},[e._v("学校范围:")])],2)],1),s("el-col",{attrs:{span:6}},[s("el-button",{attrs:{type:"primary"},on:{click:e.updateFence}},[e._v("修改")])],1)],1),s("el-col",{attrs:{span:12}},[s("el-col",{attrs:{span:18}},[s("el-input",{attrs:{placeholder:"请输入迟到时间"},model:{value:e.lateTime,callback:function(t){e.lateTime=t},expression:"lateTime"}},[s("template",{slot:"prepend"},[e._v("迟到时间:")])],2)],1),s("el-col",{attrs:{span:6}},[s("el-button",{attrs:{type:"primary"},on:{click:e.updateLateTime}},[e._v("修改")])],1)],1)],1)],2),s("el-collapse-item",{attrs:{name:"2"}},[s("template",{slot:"title"},[s("i",{staticClass:"header-icon el-icon-lx-cascades"}),e._v("迟到统计： ")]),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:"","reserve-selection":!0},on:{"row-dblclick":e.rowDblclick}},[s("el-table-column",{attrs:{type:"index",align:"center"}}),e._l(e.headerFilter,(function(t,i){return[t.selected?s("el-table-column",{key:i,attrs:{prop:t.prop,align:"center",label:t.label,formatter:t.formatter}}):e._e()]}))],2),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.searchCondition.pageSize,"current-page":e.searchCondition.pageNumber,"page-sizes":e.pageSizes,total:e.total,"hide-on-single-page":!0},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2)],1)],1),s("el-dialog",{attrs:{title:"提示",visible:e.loginVisible,width:"300px","close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.loginVisible=t}}},[s("div",{staticClass:"del-dialog-cnt"},[e._v("登录时间过长，请重新登录")]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.loginVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.Common.signOut("/login")}}},[e._v("确 定")])],1)])],1)},o=[],a=(s("159b"),s("7db0"),s("a434"),{name:"LateSituation",data:function(){return{Request:this.$api.api.prototype,Common:this.$common.common.prototype,studentUrl:"",gradeInfoUrl:"",classInfoUrl:"",deviceInfoUrl:"",schoolInfoUrl:"",deviceMoveInfoUrl:"",selectTableData:[],selectGradeCopy:[],selectClassCopy:[],selectSchoolCopy:[],selectSchool:[],selectSchoolTemplate:[],selectSchoolMove:[],selectSchoolMoveOld:[],selectSchoolMoveNew:[],selectDeviceTypeCopy:[],selectDeviceType:[],selectOperatorTypeCopy:[],selectOperatorType:[],activeNames:["1","2"],tableData:[],dialogTitle:"",editVisible:!1,innerVisible:!1,delVisible:!1,loginVisible:!1,delVisibleType:"delete",disabledbtn:!1,disabledbtnExport:!1,isDisabledbtn:!1,importVisible:!1,transferVisible:!1,transferOldVisible:!1,fileList:[],warningInfo:"",headers:{Authorization:localStorage.getItem("token")},loading:!0,loadingDialog:!1,propTypeCodeDisabled:!1,classCodeDisabled:!0,showType:"add",methodType:"post",total:8,pageSizes:[8,20,30,40,50,100],templateForm:{schoolId:""},transferForm:{schoolId:"",schoolName:""},transferOldForm:{srcId:"",srcAccount:"",destId:"",destAccount:"",imei:""},searchCondition:{schoolId:"",gradeId:"",classId:"",studentName:"",imei:"",rfid:"",phone:"",deviceCode:"",operatorType:"",pageNumber:1,pageSize:8},studentForm:{studentNo:"",name:"",sex:"",age:"",phone:"",class:"",grade:"",schoolId:"",imei:""},rules:{operatorType:[{required:!0,message:"请选择运营商",trigger:"blur"}],deviceCode:[{required:!0,message:"请选择设备类型",trigger:"blur"}],schoolId:[{required:!0,message:"请选择学校",trigger:"blur"}],imei:[{required:!0,message:"请输入IMEI号",trigger:"blur"}],rfid:[{required:!0,message:"请输入RFID号",trigger:"blur"}]},headerFilter:[{prop:"time",label:"时间",selected:!0},{prop:"situation",label:"到校情况",selected:!0},{prop:"studentName",label:"学生",selected:!0},{prop:"studentNo",label:"学号",selected:!0},{prop:"className",label:"班级",formatter:this.formatterClassName,selected:!0},{prop:"schoolName",label:"学校",selected:!0},{prop:"phone",label:"手机号",selected:!0}],idx:-1,id:-1,fence:"[[114.4098897, 23.1033580],[114.4107533, 23.1040981]]",lateTime:"08:00:00"}},created:function(){this.schoolInfoUrl=this.Request.getSchoolInfoUrl(),this.studentUrl=this.Request.getStudentUrl(),this.gradeInfoUrl=this.Request.getGradeInfoUrl(),this.classInfoUrl=this.Request.getClassInfoUrl(),this.getSchoolInfoDataRequest(),this.getListDataRequest(),this.getFenceRequest(),this.getLateTimeRequest()},computed:{},methods:{handleCurrentChange:function(e){this.searchCondition.pageNumber=e,this.getListDataRequest()},handleSizeChange:function(e){this.searchCondition.pageSize=e,this.getListDataRequest()},formatterClassName:function(e){return e.grade+"年级"+e.class+"班"},getListDataRequest:function(){this.Common.getAxios(this.Request.getLateSituationUrl(),"",this.getListData)},getSchoolInfoDataRequest:function(){this.Common.getAxios(this.Request.getSchoolInfoUrl(),"",this.getSchoolData)},getFenceRequest:function(){this.Common.getAxios(this.Request.getFenceUrl(),"",this.getFence)},getLateTimeRequest:function(){this.Common.getAxios(this.Request.getLateTimeUrl(),"",this.getLateTime)},getDeviceTypeRequest:function(){this.Common.getAxios(this.propListUrl,{propTypeCode:"DEVICE_MODEL"},this.getPropList,["selectDeviceTypeCopy","selectDeviceType"])},getOperatorTypeRequest:function(){this.Common.getAxios(this.propListUrl,{propTypeCode:"OPERATOR_TYPE"},this.getPropList,["selectOperatorTypeCopy","selectOperatorType"])},getListData:function(e){if(200===e.status){var t=e.data;this.loading=!1,this.tableData=t.data,this.total=t.data.length}else 401===e.status?this.loginVisible=!0:(this.$message.error("服务器繁忙，请稍后再试"),this.loading=!1)},getSchoolData:function(e){if(200===e.status){var t=e.data;this.loading=!1,this.selectSchool=t.data}else 401===e.status?this.loginVisible=!0:(this.$message.error("服务器繁忙，请稍后再试"),this.loading=!1)},getFence:function(e){if(200===e.status){var t=e.data;this.loading=!1,this.fence=t.data.fence}else 401===e.status?this.loginVisible=!0:(this.$message.error("服务器繁忙，请稍后再试"),this.loading=!1)},getLateTime:function(e){if(200===e.status){var t=e.data;this.loading=!1,this.lateTime=t.data.lateTime}else 401===e.status?this.loginVisible=!0:(this.$message.error("服务器繁忙，请稍后再试"),this.loading=!1)},getPropList:function(e,t){var s=this;if(200===e.status){var i=e.data;if(!this.validToken(i))return;0===i.code&&""!==i.result&&t.forEach((function(e){s[e]=i.result}))}else this.$message.error("服务器繁忙，请稍后再试")},getGradeCopyInfoData:function(e){if(200===e.status){var t=e.data;if(!this.validToken(t))return;0===t.code&&""!==t.result&&(this.searchCondition.gradeId="",this.searchCondition.classId="",this.selectGradeCopy=[],this.selectClassCopy=[],this.selectGradeCopy=t.result)}else this.$message.error("服务器繁忙，请稍后再试")},getClassInfoCopyData:function(e){if(200===e.status){var t=e.data;if(!this.validToken(t))return;0===t.code&&""!==t.result&&(this.searchCondition.classId="",this.selectClassCopy=t.result)}else this.$message.error("服务器繁忙，请稍后再试")},changeSchoolCopy:function(e){this.Common.getAxios(this.gradeInfoUrl,{schoolId:e},this.getGradeCopyInfoData)},changeSchoolTransfer:function(e){var t={};t=this.selectSchoolMove.find((function(t){return t.id===e})),this.transferForm.schoolName=t.schoolName},changeSchoolTransferOld:function(e){var t={};t=this.selectSchoolMoveOld.find((function(t){return t.id===e})),this.transferOldForm.srcAccount=t.schoolName},changeSchoolTransferNew:function(e){var t={};t=this.selectSchoolMoveNew.find((function(t){return t.id===e})),this.transferOldForm.destAccount=t.schoolName},changeGradeCopy:function(e){this.Common.getAxios(this.classInfoUrl,{gradeId:e},this.getClassInfoCopyData)},rowDblclick:function(e){this.$refs.multipleTable.toggleRowSelection(e)},handleViewEdit:function(e,t,s,i){"view"===s?(this.dialogTitle=i,this.isDisabledbtn=!0):"edit"===s&&(this.dialogTitle=i,this.methodType="put"),this.studentForm.id=t.id,this.studentForm.deviceCode=t.deviceCode,this.studentForm.operatorType=t.operatorType,this.studentForm.schoolId=t.schoolId,this.studentForm.imei=t.imei,this.studentForm.rfid=t.rfid,this.showType=s,this.propTypeCodeDisabled=!0,this.classCodeDisabled=!0,this.editVisible=!0},handleDelete:function(e,t){this.idx=e,this.id=t.id,this.delVisible=!0,this.delVisibleType="delete"},searchInfo:function(){this.loading=!0,this.searchCondition.pageNumber=1,this.getListDataRequest()},resetSearch:function(){this.searchCondition.id="",this.searchCondition.operatorType="",this.searchCondition.deviceCode="",this.searchCondition.schoolId="",this.searchCondition.gradeId="",this.searchCondition.classId="",this.searchCondition.studentName="",this.searchCondition.imei="",this.searchCondition.rfid="",this.searchCondition.phone="",this.searchInfo()},addData:function(){this.dialogTitle="新增",this.editVisible=!0},batchDelete:function(){var e=this.$refs.multipleTable.store.states.selection;this.selectTableData=e,e.length>0?(this.delVisible=!0,this.delVisibleType="batchDelete"):this.$message.warning("请至少选择一条数据")},closedFormDialog:function(){this.isDisabledbtn=!1,this.propTypeCodeDisabled=!1,this.classCodeDisabled=!0,this.studentForm.id="",this.studentForm.deviceCode="",this.studentForm.operatorType="",this.studentForm.schoolId="",this.studentForm.imei="",this.studentForm.rfid="",this.showType="add",this.methodType="post",this.$refs["imeiForm"].clearValidate()},submitForm:function(e,t,s,i){this.disabledbtn=!0,this.loadingDialog=!0,this.Common.commonAxios(s,t,i,this.submitFormInfo),this.disabledbtn=!1,this.loadingDialog=!1},submitFormInfo:function(e){if(200===e.status){var t=e.data;this.disabledbtn=!1,this.loadingDialog=!1,200===t.code?(this.editVisible=!1,this.$message.success(t.data)):this.$message.error(t.data)}else 401===e.status?this.loginVisible=!0:(this.disabledbtn=!1,this.loadingDialog=!1,this.$message.error("服务器繁忙，请稍后再试"))},deleteRow:function(e){if("delete"!==this.delVisibleType&&"batchDelete"!==this.delVisibleType)return this.delVisible=!1,void this.$message.error("别偷偷的修改特定的参数哦");var t=[],s=0,i=[];if("delete"===this.delVisibleType)i.push(this.id);else if("batchDelete"===this.delVisibleType){t=this.$refs.multipleTable.store.states.selection,s=t.length;for(var o=0;o<s;o++)i.push(t[o].id)}this.loading=!0,this.disabledbtn=!0,this.Common.deleteAxios(e,{idArray:i},this.deleteInfo,i),this.delVisible=!1},deleteInfo:function(e,t){if(this.disabledbtn=!1,this.loading=!1,200===e.status){var s=e.data;if(!this.validToken(s))return;if(0!==s.code)return void this.$message.error(s.message);for(var i=this.tableData.length-1;i>=0;i--)for(var o=0;o<t.length;o++)if(t[o]===this.tableData[i].id){this.tableData.splice(i,1);break}this.$message.success("成功删除了".concat(t.length,"条数据")),this.selectTableData=[]}else this.$message.error("服务器繁忙，请稍后再试")},validToken:function(e){return 2001!==e.code&&2101!==e.code&&2102!==e.code||(this.loginVisible=!0,!1)},cancelImport:function(){this.importVisible=!1},handleFileSuccess:function(e){0!==e.code?(this.fileList=[],this.$message.warning(e.message),this.warningInfo=e.message):(this.$message.success("批量导入成功"),this.getListDataRequest())},updateFence:function(){var e={schoolID:1,fence:this.fence};this.submitForm("updateFence","post",this.Request.getFenceUrl(),e)},updateLateTime:function(){var e={schoolID:1,lateTime:this.lateTime};this.submitForm("updateLateTime","post",this.Request.getLateTimeUrl(),e)}}}),l=a,n=(s("d9e2"),s("2877")),r=Object(n["a"])(l,i,o,!1,null,"e2da78e0",null);t["default"]=r.exports}}]);
//# sourceMappingURL=chunk-52733a01.c7032b46.js.map