{"remainingRequest":"/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/babel-loader/lib/index.js!/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/vux/src/components/x-form/field.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/vux/src/components/x-form/field.vue","mtime":1635777723566},{"path":"/Users/zrun/vueSpace/ecard_manager_frontend/babel.config.js","mtime":1635402255166},{"path":"/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/cache-loader/dist/cjs.js","mtime":1635231739476},{"path":"/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/babel-loader/lib/index.js","mtime":1635231739480},{"path":"/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/cache-loader/dist/cjs.js","mtime":1635231739476},{"path":"/Users/zrun/vueSpace/ecard_manager_frontend/node_modules/vue-loader/lib/index.js","mtime":1635231911752}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEFzeW5jVmFsaWRhdG9yIGZyb20gJ2FzeW5jLXZhbGlkYXRvcic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnVnV4Rm9ybUZpZWxkJywKICBpbmplY3Q6IFsnZm9ybSddLAogIHByb3BzOiB7CiAgICBwcm9wOiBTdHJpbmcsCiAgICBydWxlczogW09iamVjdCwgQXJyYXldLAogICAgcmVxdWlyZWQ6IEJvb2xlYW4sCiAgICBtZXNzYWdlOiBTdHJpbmcKICB9LAogIGNvbXB1dGVkOiB7CiAgICBpc1JlcXVpcmVkOiBmdW5jdGlvbiBpc1JlcXVpcmVkKCkgewogICAgICB2YXIgcnVsZXMgPSB0aGlzLnJ1bGVzLAogICAgICAgICAgcmVxdWlyZWQgPSB0aGlzLnJlcXVpcmVkOwoKICAgICAgaWYgKHJ1bGVzICYmIHJ1bGVzLmxlbmd0aCkgewogICAgICAgIHZhciBydWxlc1JlcXVpcmVkID0gcnVsZXMuZXZlcnkoZnVuY3Rpb24gKHJ1bGUpIHsKICAgICAgICAgIHJldHVybiBydWxlLnJlcXVpcmVkOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBydWxlc1JlcXVpcmVkIHx8IHJlcXVpcmVkOwogICAgICB9CgogICAgICByZXR1cm4gcmVxdWlyZWQ7CiAgICB9LAogICAgbW9kZWxWYWx1ZTogZnVuY3Rpb24gbW9kZWxWYWx1ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuZm9ybS5tb2RlbFt0aGlzLnByb3BdOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGZpZWxkVmFsdWU6IGZ1bmN0aW9uIGZpZWxkVmFsdWUodmFsKSB7CiAgICAgIHRoaXMudmFsaWRhdGUoKTsKICAgICAgdGhpcy4kZW1pdCgnb24tY2hhbmdlJywgdmFsKTsKICAgICAgdGhpcy5mb3JtLm1vZGVsW3RoaXMucHJvcF0gPSB2YWw7CiAgICB9LAogICAgbW9kZWxWYWx1ZTogZnVuY3Rpb24gbW9kZWxWYWx1ZSh2YWwpIHsKICAgICAgdGhpcy5maWVsZFZhbHVlID0gdmFsOwogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpZWxkVmFsdWU6IHRoaXMuZm9ybS5tb2RlbFt0aGlzLnByb3BdLAogICAgICB2YWxpZGF0ZVN0YXRlOiAnJywKICAgICAgdmFsaWRhdGVNZXNzYWdlOiB0aGlzLm1lc3NhZ2UsCiAgICAgIGluaXRpYWxWYWx1ZTogJycKICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIGZpZWxkVmFsdWUgPSB0aGlzLmZpZWxkVmFsdWU7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoZmllbGRWYWx1ZSkpIHsKICAgICAgdGhpcy5pbml0aWFsVmFsdWUgPSBbXS5jb25jYXQoZmllbGRWYWx1ZSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmluaXRpYWxWYWx1ZSA9IGZpZWxkVmFsdWU7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRSdWxlczogZnVuY3Rpb24gZ2V0UnVsZXMoKSB7CiAgICAgIHZhciBzZWxmUnVsZXMgPSB0aGlzLnJ1bGVzIHx8IFtdOwogICAgICB2YXIgcmVxdWlyZWRSdWxlID0gdGhpcy5pc1JlcXVpcmVkICE9PSB1bmRlZmluZWQgPyB7CiAgICAgICAgcmVxdWlyZWQ6ICEhdGhpcy5pc1JlcXVpcmVkCiAgICAgIH0gOiBbXTsKCiAgICAgIGlmICh0aGlzLm1lc3NhZ2UgJiYgdGhpcy5pc1JlcXVpcmVkKSB7CiAgICAgICAgcmVxdWlyZWRSdWxlLm1lc3NhZ2UgPSB0aGlzLm1lc3NhZ2U7CiAgICAgIH0KCiAgICAgIHJldHVybiBzZWxmUnVsZXMuc29tZShmdW5jdGlvbiAocnVsZXMpIHsKICAgICAgICByZXR1cm4gcnVsZXMucmVxdWlyZWQ7CiAgICAgIH0pID8gW10uY29uY2F0KHNlbGZSdWxlcykgOiBbXS5jb25jYXQoc2VsZlJ1bGVzLCByZXF1aXJlZFJ1bGUpOwogICAgfSwKICAgIHZhbGlkYXRlOiBmdW5jdGlvbiB2YWxpZGF0ZShjYikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHJ1bGVzID0gdGhpcy5nZXRSdWxlcygpOwogICAgICB2YXIgZGVzY3JpcHRvciA9IHt9OwogICAgICBkZXNjcmlwdG9yW3RoaXMucHJvcF0gPSBydWxlczsKICAgICAgdmFyIHZhbGlkYXRvciA9IG5ldyBBc3luY1ZhbGlkYXRvcihkZXNjcmlwdG9yKTsKICAgICAgdmFyIG1vZGVsID0ge307CiAgICAgIG1vZGVsW3RoaXMucHJvcF0gPSB0aGlzLmZpZWxkVmFsdWU7CiAgICAgIHZhbGlkYXRvci52YWxpZGF0ZShtb2RlbCwgewogICAgICAgIGZpcnN0RmllbGRzOiB0cnVlCiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcnMsIGludmFsaWRGaWVsZHMpIHsKICAgICAgICBfdGhpcy52YWxpZGF0ZVN0YXRlID0gZXJyb3JzID8gJ2Vycm9yJyA6ICdzdWNjZXNzJzsKICAgICAgICBfdGhpcy52YWxpZHRlTWVzc2FnZSA9IGVycm9ycyA/IGVycm9yc1swXS5tZXNzYWdlIDogJyc7CiAgICAgICAgY2IoX3RoaXMudmFsaWR0ZU1lc3NhZ2UsIGludmFsaWRGaWVsZHMpOwogICAgICB9KTsKICAgIH0sCiAgICBjbGVhclZhbGlkYXRlOiBmdW5jdGlvbiBjbGVhclZhbGlkYXRlKCkgewogICAgICB0aGlzLnZhbGlkYXRlU3RhdGUgPSAnJzsKICAgICAgdGhpcy52YWxpZGF0ZU1lc3NhZ2UgPSAnJzsKICAgIH0sCiAgICByZXNldEZpZWxkOiBmdW5jdGlvbiByZXNldEZpZWxkKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBpbml0aWFsVmFsdWUgPSB0aGlzLmluaXRpYWxWYWx1ZTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGluaXRpYWxWYWx1ZSkpIHsKICAgICAgICB0aGlzLmZpZWxkVmFsdWUgPSBbXS5jb25jYXQoaW5pdGlhbFZhbHVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZpZWxkVmFsdWUgPSBpbml0aWFsVmFsdWU7CiAgICAgIH0KCiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczIuY2xlYXJWYWxpZGF0ZSgpOwogICAgICB9KTsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmZvcm0uYWRkRmllbGQodGhpcyk7CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy5mb3JtLnJlbW92ZUZpZWxkKHRoaXMpOwogIH0KfTs="},{"version":3,"sources":["field.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div\r\n    class=\"vux-form-field\"\r\n    :class=\"{\r\n    'is-required': isRequired,\r\n    'is-success': validateState === 'success',\r\n    'is-error': validateState === 'error',\r\n  }\"\r\n  >\r\n    <slot></slot>\r\n  </div>\r\n</template>\r\n<script>\r\nimport AsyncValidator from 'async-validator'\r\nexport default {\r\n  name: 'VuxFormField',\r\n  inject: ['form'],\r\n  props: {\r\n    prop: String,\r\n    rules: [Object, Array],\r\n    required: Boolean,\r\n    message: String\r\n  },\r\n  computed: {\r\n    isRequired () {\r\n      const { rules, required } = this\r\n      if (rules && rules.length) {\r\n        const rulesRequired = rules.every((rule) => rule.required)\r\n        return rulesRequired || required\r\n      }\r\n      return required\r\n    },\r\n    modelValue () {\r\n      return this.form.model[this.prop]\r\n    }\r\n  },\r\n  watch: {\r\n    fieldValue (val) {\r\n      this.validate()\r\n      this.$emit('on-change', val)\r\n      this.form.model[this.prop] = val\r\n    },\r\n    modelValue (val) {\r\n      this.fieldValue = val\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      fieldValue: this.form.model[this.prop],\r\n      validateState: '',\r\n      validateMessage: this.message,\r\n      initialValue: ''\r\n    }\r\n  },\r\n  mounted () {\r\n    const { fieldValue } = this\r\n    if (Array.isArray(fieldValue)) {\r\n      this.initialValue = [].concat(fieldValue)\r\n    } else {\r\n      this.initialValue = fieldValue\r\n    }\r\n  },\r\n  methods: {\r\n    getRules () {\r\n      const selfRules = this.rules || []\r\n      const requiredRule =\r\n        this.isRequired !== undefined ? { required: !!this.isRequired } : []\r\n      if (this.message && this.isRequired) {\r\n        requiredRule.message = this.message\r\n      }\r\n      return selfRules.some((rules) => rules.required)\r\n        ? [].concat(selfRules)\r\n        : [].concat(selfRules, requiredRule)\r\n    },\r\n    validate (cb) {\r\n      const rules = this.getRules()\r\n      const descriptor = {}\r\n      descriptor[this.prop] = rules\r\n      const validator = new AsyncValidator(descriptor)\r\n      const model = {}\r\n      model[this.prop] = this.fieldValue\r\n      validator.validate(\r\n        model,\r\n        { firstFields: true },\r\n        (errors, invalidFields) => {\r\n          this.validateState = errors ? 'error' : 'success'\r\n          this.validteMessage = errors ? errors[0].message : ''\r\n          cb(this.validteMessage, invalidFields)\r\n        }\r\n      )\r\n    },\r\n    clearValidate () {\r\n      this.validateState = ''\r\n      this.validateMessage = ''\r\n    },\r\n    resetField () {\r\n      const { initialValue } = this\r\n      if (Array.isArray(initialValue)) {\r\n        this.fieldValue = [].concat(initialValue)\r\n      } else {\r\n        this.fieldValue = initialValue\r\n      }\r\n      this.$nextTick(() => {\r\n        this.clearValidate()\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    this.form.addField(this)\r\n  },\r\n  beforeDestroy () {\r\n    this.form.removeField(this)\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\">\r\n.vux-form-field {\r\n  position: relative;\r\n  &:after {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    height: 1px;\r\n    color: #d9d9d9;\r\n    border-top: 1px solid #d9d9d9;\r\n    left: 15px;\r\n    content: '';\r\n    transform: scaleY(0.5);\r\n    transform-origin: 0 0;\r\n  }\r\n  &.is-required {\r\n    display: flex;\r\n    align-items: flex-start;\r\n    &::before {\r\n      content: '*';\r\n      display: inline-block;\r\n      vertical-align: middle;\r\n      padding-left: 15px;\r\n      padding-top: 12px;\r\n      color: red;\r\n    }\r\n    .weui-cell,\r\n    .vux-cell-box,\r\n    .vux-uploader {\r\n      flex: 1;\r\n    }\r\n  }\r\n  &.is-error {\r\n    color: red;\r\n    input::placeholder,\r\n    textarea::placeholder {\r\n      color: red;\r\n    }\r\n    input::-webkit-input-placeholder,\r\n    textarea::-webkit-input-placeholder {\r\n      color: red;\r\n    }\r\n    input::-moz-placeholder,\r\n    textarea::-moz-placeholder {\r\n      color: red;\r\n    }\r\n    input:-ms-input-placeholder,\r\n    textarea:-ms-input-placeholder {\r\n      color: red;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"node_modules/vux/src/components/x-form"}]}